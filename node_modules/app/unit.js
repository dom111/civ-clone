'use strict';

const EventEmitter = require('events');
const util = require('util');

module.exports = (function() {
    var Unit = class Unit {
        constructor(details) {
            EventEmitter.call(this);

            var unit = this;

            unit.player = game.players[0]; // TODO
            unit.destroyed = false;

            unit.player.units.push(unit);

            details = details || {};

            game.emit('unit-created', unit);

            unit.on('destroyed', function(player) {
                this.destroyed = true;

                if (!this.player.units.map(function(city) {
                    return city.destroyed;
                }).some(function(value) {
                    return value === true;
                })) {
                    // TODO: all cities destroyed
                    console.log('All units destroyed.');
                }

                // TODO: remove from map
            });
        }
    };

    util.inherits(Unit, EventEmitter);

    return Unit;
})();

